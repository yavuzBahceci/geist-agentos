# Phase 2: Library Research

Deep-dive research on libraries related to the issue.

## Step 1: Load Issue Analysis

Load the issue analysis from Phase 1:

```bash
CACHE_PATH="geist/output/fix-bug/cache"

if [ -f "$CACHE_PATH/issue-analysis.md" ]; then
    ISSUE_ANALYSIS=$(cat "$CACHE_PATH/issue-analysis.md")
    echo "âœ… Loaded issue analysis"
else
    echo "âŒ Issue analysis not found. Run Phase 1 first."
    exit 1
fi

# Extract affected libraries
AFFECTED_LIBRARIES=$(grep -A 10 "### Libraries" "$CACHE_PATH/issue-analysis.md" | grep -v "^#" | head -10)
```

## Step 2: Research Internal Architecture

For each affected library, research its internal architecture:

```bash
echo "ðŸ” Researching library internal architecture..."

LIBRARY_RESEARCH=""

for library in $AFFECTED_LIBRARIES; do
    if [ -z "$library" ]; then
        continue
    fi
    
    echo "   Researching: $library"
    
    # Web search for internal architecture
    # web_search("$library internal architecture how it works")
    # web_search("$library core concepts design")
    
    LIBRARY_RESEARCH="${LIBRARY_RESEARCH}
## $library

### Internal Architecture
[Research findings about internal architecture]

### Core Concepts
[Key concepts and design patterns]

### Component Interactions
[How components interact within the library]
"
done
```

## Step 3: Research Known Issues and Bug Patterns

Research known issues and common bug patterns for affected libraries:

```bash
echo "ðŸ” Researching known issues and bug patterns..."

KNOWN_ISSUES=""

for library in $AFFECTED_LIBRARIES; do
    if [ -z "$library" ]; then
        continue
    fi
    
    echo "   Researching known issues: $library"
    
    # Web search for known issues
    # web_search("$library common issues bugs")
    # web_search("$library known problems gotchas")
    # web_search("$library error $ERROR_CODE") # if error code exists
    
    KNOWN_ISSUES="${KNOWN_ISSUES}
## $library Known Issues

### Common Problems
[Common problems and their solutions]

### Bug Patterns
[Known bug patterns in this library]

### Related GitHub Issues
[Relevant GitHub issues if found]
"
done
```

## Step 4: Research Error Scenarios

Research how library components interact in error scenarios:

```bash
echo "ðŸ” Researching error scenarios..."

ERROR_SCENARIOS=""

for library in $AFFECTED_LIBRARIES; do
    if [ -z "$library" ]; then
        continue
    fi
    
    echo "   Researching error scenarios: $library"
    
    # Web search for error handling
    # web_search("$library error handling")
    # web_search("$library exception handling best practices")
    
    ERROR_SCENARIOS="${ERROR_SCENARIOS}
## $library Error Scenarios

### Error Handling Patterns
[How errors are typically handled]

### Common Error Causes
[What typically causes errors in this library]

### Recovery Strategies
[How to recover from errors]
"
done
```

## Step 5: Create Library Research Document

Generate the library research document:

```bash
echo "ðŸ“ Creating library research document..."

cat > "$CACHE_PATH/library-research.md" << 'RESEARCH_EOF'
# Library Research

## Research Summary
- **Libraries Researched:** [count]
- **Research Date:** $(date)

---

## Library Internal Architecture

$LIBRARY_RESEARCH

---

## Known Issues and Bug Patterns

$KNOWN_ISSUES

---

## Error Scenarios

$ERROR_SCENARIOS

---

## Key Findings

### Most Relevant to This Issue
[Summarize findings most relevant to the current issue]

### Potential Root Causes
[Based on research, potential root causes of the issue]

### Suggested Approaches
[Approaches suggested by library documentation/community]

---

*Generated by fix-bug command - Phase 2*
RESEARCH_EOF

echo "âœ… Library research complete"
echo "   Research saved to: $CACHE_PATH/library-research.md"
```

## Display Progress and Next Step

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ“š PHASE 2: LIBRARY RESEARCH COMPLETE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… Libraries researched: [count]
âœ… Internal architecture documented
âœ… Known issues identified
âœ… Error scenarios analyzed

Research saved to: geist/output/fix-bug/cache/library-research.md

NEXT STEP ðŸ‘‰ Proceeding to Phase 3: Basepoints Integration
```
